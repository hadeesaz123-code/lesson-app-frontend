(function(){"use strict";var e={6425:function(e,t,s){var o=s(5130),a=s(6768),n=s(4232);const l={id:"app"},r={class:"header"},i={class:"header-actions"},c={key:2,class:"auth-user"},u=["disabled"],d={class:"cart-label"},h={key:0,class:"cart-badge"},p={class:"layout"},m={key:0},k={class:"footer"},v={class:"footer-content"},L={key:1,class:"cart-page"},f={key:0,class:"empty"},C={key:1,class:"cart-list"},g=["onClick"],b={class:"checkout"},y={class:"summary"},w=["disabled"],E={key:0,class:"auth-backdrop"},_={class:"auth-modal"},A={key:0},X={key:1},O={class:"auth-actions"};function S(e,t,s,S,j,T){const P=(0,a.g2)("LessonList");return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("header",r,[t[15]||(t[15]=(0,a.Lk)("div",{class:"header-title"},[(0,a.Lk)("h1",null,"After School Activities"),(0,a.Lk)("p",null,"Discover activities for your child")],-1)),(0,a.Lk)("div",i,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>j.searchQuery=e),placeholder:"Search activities...",class:"search-input"},null,512),[[o.Jo,j.searchQuery]]),j.currentUser?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,class:"auth-btn",onClick:t[1]||(t[1]=e=>T.openAuth("login"))}," Login ")),j.currentUser?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:1,class:"auth-btn",onClick:t[2]||(t[2]=e=>T.openAuth("register"))}," Register ")),j.currentUser?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.eW)((0,n.v_)(j.currentUser.name)+" ",1),(0,a.Lk)("button",{class:"auth-btn",onClick:t[3]||(t[3]=(...e)=>T.logout&&T.logout(...e))}," Logout ")])):(0,a.Q3)("",!0),(0,a.Lk)("button",{class:"cart-toggle",disabled:0===j.cart.length,onClick:t[4]||(t[4]=(...e)=>T.toggleCart&&T.toggleCart(...e))},[(0,a.Lk)("span",d,(0,n.v_)(j.showCart?"Back to lessons":"View cart"),1),j.cart.length?((0,a.uX)(),(0,a.CE)("span",h,(0,n.v_)(j.cart.length),1)):(0,a.Q3)("",!0)],8,u)])]),(0,a.Lk)("main",p,[j.showCart?((0,a.uX)(),(0,a.CE)("div",L,[t[20]||(t[20]=(0,a.Lk)("h2",null,"Your cart",-1)),0===j.cart.length?((0,a.uX)(),(0,a.CE)("div",f," Your cart is empty. ")):((0,a.uX)(),(0,a.CE)("ul",C,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(j.cart,(e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:e.id+"-"+t,class:"cart-item"},[(0,a.Lk)("span",null,(0,n.v_)(e.subject)+" — £"+(0,n.v_)(e.price),1),(0,a.Lk)("button",{onClick:e=>T.removeFromCart(t),class:"remove-btn"}," Remove ",8,g)]))),128))])),(0,a.Lk)("div",b,[t[19]||(t[19]=(0,a.Lk)("h3",null,"Checkout",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>j.name=e),placeholder:"Your name",class:(0,n.C4)({invalid:j.name&&!T.validName})},null,2),[[o.Jo,j.name]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>j.phone=e),placeholder:"Phone number",class:(0,n.C4)({invalid:j.phone&&!T.validPhone})},null,2),[[o.Jo,j.phone]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>j.email=e),placeholder:"Email",class:(0,n.C4)({invalid:j.email&&!T.validEmail})},null,2),[[o.Jo,j.email]]),(0,a.Lk)("div",y,[t[18]||(t[18]=(0,a.Lk)("span",null,"Total:",-1)),(0,a.Lk)("strong",null,"£"+(0,n.v_)(T.totalPrice.toFixed(2)),1)]),(0,a.Lk)("button",{class:"checkout-btn",disabled:!T.canCheckout,onClick:t[9]||(t[9]=(...e)=>T.confirmOrder&&T.confirmOrder(...e))}," Confirm order ",8,w)])])):((0,a.uX)(),(0,a.CE)("div",m,[(0,a.bF)(P,{search:j.searchQuery,onAddToCart:T.onAddToCart},null,8,["search","onAddToCart"]),(0,a.Lk)("footer",k,[(0,a.Lk)("div",v,[(0,a.Lk)("div",{class:"footer-item footer-link",onClick:t[5]||(t[5]=(...e)=>T.goHome&&T.goHome(...e))},"Home"),t[16]||(t[16]=(0,a.Lk)("div",{class:"footer-item"},"Phone: 07123 456789",-1)),t[17]||(t[17]=(0,a.Lk)("div",{class:"footer-item"},"Email: info@example.com",-1))])])]))]),j.showAuthModal?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("div",_,["login"===j.authMode?((0,a.uX)(),(0,a.CE)("h2",A,"Login")):((0,a.uX)(),(0,a.CE)("h2",X,"Create account")),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>j.authEmail=e),type:"email",placeholder:"Email"},null,512),[[o.Jo,j.authEmail]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>j.authPassword=e),type:"password",placeholder:"Password"},null,512),[[o.Jo,j.authPassword]]),"register"===j.authMode?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:2,"onUpdate:modelValue":t[12]||(t[12]=e=>j.authName=e),type:"text",placeholder:"Full name"},null,512)),[[o.Jo,j.authName]]):(0,a.Q3)("",!0),(0,a.Lk)("div",O,[(0,a.Lk)("button",{class:"auth-primary",onClick:t[13]||(t[13]=(...e)=>T.submitAuth&&T.submitAuth(...e))},(0,n.v_)("login"===j.authMode?"Login":"Create account"),1),(0,a.Lk)("button",{class:"auth-secondary",onClick:t[14]||(t[14]=(...e)=>T.closeAuth&&T.closeAuth(...e))}," Cancel ")])])])):(0,a.Q3)("",!0)])}s(4114),s(8111),s(1701),s(8237);const j={class:"lesson-list"},T={key:0,class:"loading"},P={key:1,class:"lessons"},U=["onClick"],Q={class:"card-image"},M=["src","alt"],N={class:"card-body"},J={class:"title"},$={class:"desc"},F={class:"meta-row"},x={class:"info"},I={class:"price"},V={class:"spaces"},D={class:"actions"},H=["disabled","onClick"],W={key:2,class:"modal-backdrop"},q={class:"modal"},R=["src"],Y={class:"detail-desc"},K=["disabled"];function z(e,t,s,l,r,i){return(0,a.uX)(),(0,a.CE)("div",j,[r.loading?((0,a.uX)(),(0,a.CE)("div",T,"Loading lessons…")):((0,a.uX)(),(0,a.CE)("ul",P,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.filteredLessons,e=>((0,a.uX)(),(0,a.CE)("li",{key:e._id||e.subject,class:"lesson-card",onClick:t=>i.openDetails(e)},[(0,a.Lk)("div",Q,[e.image?((0,a.uX)(),(0,a.CE)("img",{key:0,src:i.imageSrc(e.image),alt:e.subject},null,8,M)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",N,[(0,a.Lk)("h3",J,(0,n.v_)(e.subject),1),(0,a.Lk)("p",$,(0,n.v_)(e.description),1),(0,a.Lk)("div",F,[(0,a.Lk)("div",x,[(0,a.Lk)("span",I,"£"+(0,n.v_)(e.price),1),(0,a.Lk)("span",V,(0,n.v_)(e.spaces)+" spaces",1)]),(0,a.Lk)("div",D,[(0,a.Lk)("button",{disabled:e.spaces<=0,onClick:(0,o.D$)(t=>i.addToCart(e),["stop"])},(0,n.v_)(e.spaces>0?"Add to cart":"Full"),9,H)])])])],8,U))),128))])),r.selectedLesson?((0,a.uX)(),(0,a.CE)("div",W,[(0,a.Lk)("div",q,[(0,a.Lk)("h2",null,(0,n.v_)(r.selectedLesson.subject),1),r.selectedLesson.image?((0,a.uX)(),(0,a.CE)("img",{key:0,src:i.imageSrc(r.selectedLesson.image),class:"detail-img"},null,8,R)):(0,a.Q3)("",!0),(0,a.Lk)("p",Y,(0,n.v_)(r.selectedLesson.description),1),(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Price:",-1)),(0,a.eW)(" £"+(0,n.v_)(r.selectedLesson.price),1)]),(0,a.Lk)("p",null,[t[3]||(t[3]=(0,a.Lk)("strong",null,"Location:",-1)),(0,a.eW)(" "+(0,n.v_)(r.selectedLesson.location),1)]),(0,a.Lk)("p",null,[t[4]||(t[4]=(0,a.Lk)("strong",null,"Spaces left:",-1)),(0,a.eW)(" "+(0,n.v_)(r.selectedLesson.spaces),1)]),(0,a.Lk)("button",{class:"add-btn",disabled:r.selectedLesson.spaces<=0,onClick:t[0]||(t[0]=e=>i.addToCart(r.selectedLesson))}," Add to cart ",8,K),(0,a.Lk)("button",{class:"close-btn",onClick:t[1]||(t[1]=(...e)=>i.closeDetails&&i.closeDetails(...e))},"Close")])])):(0,a.Q3)("",!0)])}s(2489);const B="localhost"===window.location.hostname?"http://localhost:3000":"https://lesson-app-backend-7mte.onrender.com";var Z={name:"LessonList",props:{search:{type:String,default:""}},data(){return{lessons:[],loading:!0,searchTimer:null,selectedLesson:null}},watch:{search(e){this.debounceSearch(e)}},computed:{filteredLessons(){const e=this.search.toLowerCase().trim();return e?this.lessons.filter(t=>(t.subject||"").toLowerCase().includes(e)||(t.description||"").toLowerCase().includes(e)):this.lessons}},methods:{async fetchLessons(){try{const e=await fetch(`${B}/lessons`);this.lessons=await e.json()}catch(e){console.error("Error loading lessons:",e)}finally{this.loading=!1}},debounceSearch(e){clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>this.doSearch(e),250)},async doSearch(e){if(!e)return this.fetchLessons();try{const t=await fetch(`${B}/search?q=${encodeURIComponent(e)}`);this.lessons=await t.json()}catch(t){console.error("Search failed:",t)}},imageSrc(e){return e||""},addToCart(e){this.$emit("add-to-cart",{id:e._id||e.subject,subject:e.subject,price:e.price,quantity:1}),e.spaces--},openDetails(e){this.selectedLesson=e},closeDetails(){this.selectedLesson=null}},mounted(){this.fetchLessons()}},G=s(1241);const ee=(0,G.A)(Z,[["render",z],["__scopeId","data-v-35120f32"]]);var te=ee;const se="localhost"===window.location.hostname?"http://localhost:3000":"https://lesson-app-backend-7mte.onrender.com";var oe={components:{LessonList:te},data(){return{searchQuery:"",showCart:!1,cart:[],name:"",phone:"",email:"",showAuthModal:!1,authMode:"login",authEmail:"",authPassword:"",authName:"",currentUser:null}},mounted(){const e=localStorage.getItem("user");e&&(this.currentUser=JSON.parse(e))},computed:{validName(){return/^[A-Za-z\s]+$/.test(this.name)},validPhone(){return/^\d+$/.test(this.phone)},validEmail(){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.email)},canCheckout(){return this.cart.length>0&&this.validName&&this.validPhone&&this.validEmail},totalPrice(){return this.cart.reduce((e,t)=>e+t.price,0)}},methods:{onAddToCart(e){this.cart.push(e)},toggleCart(){this.showCart=!this.showCart},removeFromCart(e){this.cart.splice(e,1),0===this.cart.length&&(this.showCart=!1)},goHome(){this.showCart=!1,this.searchQuery="",window.scrollTo(0,0)},openAuth(e){this.authMode=e,this.showAuthModal=!0,this.authEmail="",this.authPassword="",this.authName=""},closeAuth(){this.showAuthModal=!1},async submitAuth(){const e="login"===this.authMode?"/login":"/register",t={email:this.authEmail,password:this.authPassword,name:"register"===this.authMode?this.authName:void 0};try{const s=await fetch(`${se}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await s.json();if(!s.ok)return void alert(o.error||"Authentication failed");this.currentUser=o.user||{name:t.name,email:t.email},localStorage.setItem("user",JSON.stringify(this.currentUser)),alert(o.message),this.closeAuth()}catch(s){alert("Connection error")}},logout(){this.currentUser=null,localStorage.removeItem("user"),alert("Logged out")},async confirmOrder(){if(!this.canCheckout)return;const e={name:this.name,phone:this.phone,email:this.email,items:this.cart.map(e=>({lessonId:e.id,quantity:1}))};await fetch(`${se}/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),alert("Order placed!"),this.cart=[],this.showCart=!1}}};const ae=(0,G.A)(oe,[["render",S]]);var ne=ae;(0,o.Ef)(ne).mount("#app")}},t={};function s(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,o,a,n){if(!o){var l=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],n=e[u][2];for(var r=!0,i=0;i<o.length;i++)(!1&n||l>=n)&&Object.keys(s.O).every(function(e){return s.O[e](o[i])})?o.splice(i--,1):(r=!1,n<l&&(l=n));if(r){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[o,a,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,n,l=o[0],r=o[1],i=o[2],c=0;if(l.some(function(t){return 0!==e[t]})){for(a in r)s.o(r,a)&&(s.m[a]=r[a]);if(i)var u=i(s)}for(t&&t(o);c<l.length;c++)n=l[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(u)},o=self["webpackChunklesson_app_frontend"]=self["webpackChunklesson_app_frontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[504],function(){return s(6425)});o=s.O(o)})();
//# sourceMappingURL=app.38f1045e.js.map